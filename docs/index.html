<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BrAPI • BrAPI</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="BrAPI">
<meta name="description" content="Simple wrapper functions for httr that make it easier to make manual HTTP calls to a BrAPI server">
<meta property="og:description" content="Simple wrapper functions for httr that make it easier to make manual HTTP calls to a BrAPI server">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">BrAPI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="brapir">BrAPI.R<a class="anchor" aria-label="anchor" href="#brapir"></a>
</h1></div>
<p>This R package contains a simple R6 Class for interacting with a BrAPI server. It holds all of the information needed to connect to a server (such as the hostname) and has helper functions for making an HTTP requests to the BrAPI server.</p>
<p>It does not have any knowledge of the currently supported BrAPI endpoints. You’ll need to refer to the <a href="https://brapi.org/specification" class="external-link">BrAPI specification</a> to know which endpoints to use and how the response will be formatted.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get a BrAPI Connection</span></span>
<span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/Wheat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get Studies associated with the Cornell breeding program</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"/studies"</span>, query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>programName<span class="op">=</span><span class="st">"Cornell University"</span><span class="op">)</span>, pageSize<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">data</span></span>
<span> </span>
<span><span class="co"># Get all Germplasm stored in the database</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"/germplasm"</span>, page<span class="op">=</span><span class="st">"all"</span>, pageSize<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span><span class="va">germplasm</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">combined_data</span></span></code></pre></div>
<div class="section level3">
<h3 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h3>
<p>A more in-depth tutorial using data from T3/Wheat can be found in the TUTORIAL.md file.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package can be installed directly from GitHub, using the <code>devtools</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools, if you haven't already</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install the BrAPI package from GitHub</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"TriticeaeToolbox/BrAPI.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://triticeaetoolbox.github.io/BrAPI.R/">BrAPI</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Reference Documentation can be found here: <a href="https://triticeaetoolbox.github.io/BrAPI.R">https://triticeaetoolbox.github.io/BrAPI.R</a></p>
</div>
<div class="section level2">
<h2 id="creating-a-brapi-connection">Creating a BrAPI Connection<a class="anchor" aria-label="anchor" href="#creating-a-brapi-connection"></a>
</h2>
<p>The <a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html">BrAPIConnection Class</a> contains information about the BrAPI server and has helper functions for making HTTP requests.</p>
<p>There are some known pre-configured BrAPI connections included with this package. To see the list of known BrAPI connections, use the <a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/listBrAPIConnections.html">listBrAPIConnections() function</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/listBrAPIConnections.html">listBrAPIConnections</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># PRINTS:</span></span>
<span><span class="co"># Known BrAPI Connections:</span></span>
<span><span class="co">#  T3/Wheat = wheat.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  T3/Wheat Sandbox = wheat-sandbox.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  T3/Oat = oat.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  T3/Oat Sandbox = oat-sandbox.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  T3/Barley = barley.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  T3/Barley Sandbox = barley-sandbox.triticeaetoolbox.org [v2]</span></span>
<span><span class="co">#  Cassavabase = cassavabase.org [v2]</span></span></code></pre></div>
<p>To use a known BrAPI connection, reference it by name in the <a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/getBrAPIConnection.html">getBrAPIConnection() function</a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/Wheat"</span><span class="op">)</span></span></code></pre></div>
<p>To manually create a BrAPI connection, you’ll need to specify the host of the BrAPI server (and optionally set the protocol, path, and/or version) in the <a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/createBrAPIConnection.html">createBrAPIConnection() function</a>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kelp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBrAPIConnection.html">createBrAPIConnection</a></span><span class="op">(</span><span class="st">"sugarkelpbase.org"</span><span class="op">)</span></span>
<span><span class="va">kelpv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBrAPIConnection.html">createBrAPIConnection</a></span><span class="op">(</span><span class="st">"sugarkelpbase.org"</span>, version<span class="op">=</span><span class="st">"v1"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="breedbase-connections">Breedbase Connections<a class="anchor" aria-label="anchor" href="#breedbase-connections"></a>
</h3>
<p>This package includes some breedbase-specific helper functions (such as programatically using the Search Wizard) that are only available for breedbase BrAPI instances. When using the <code><a href="reference/createBrAPIConnection.html">createBrAPIConnection()</a></code> function, add the <code>is_breedbase=TRUE</code> argument to enable the breedbase-specific functions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBrAPIConnection.html">createBrAPIConnection</a></span><span class="op">(</span><span class="st">"wheat.triticeaetoolbox.org"</span>, is_breedbase<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>When using the known connections via the <code><a href="reference/getBrAPIConnection.html">getBrAPIConnection()</a></code> function, the <code>is_breedbase</code> argument will automatically be added for breedbase connections.</p>
</div>
</div>
<div class="section level2">
<h2 id="authorization">Authorization<a class="anchor" aria-label="anchor" href="#authorization"></a>
</h2>
<p>Some databases may require authorization for all or some endpoints (such as those that are used to add or update data in the database). Since authorization methods have not been standardized across all BrAPI databases, each database may handle it slighly differently - please refer to the documentation of the BrAPI database or tool you’re trying to connect to for details.</p>
<p>This package assumes that authorization is handled by adding a <code>Authorization: Bearer {token}</code> header to the requests.</p>
<div class="section level3">
<h3 id="breedbase-databases">Breedbase Databases<a class="anchor" aria-label="anchor" href="#breedbase-databases"></a>
</h3>
<p>If you’re connecting to a breedbase database, you can use the BrAPI Connection’s <code>login(username, password)</code> function to get an authorization token that will be used in all future requests for that connection. Alternatively, you can use the <code>login()</code> function without the username and password and you will be prompted to enter your username and password when the function is called.</p>
<p>The <code>login()</code> function will send a <code>POST</code> request to the the <code>/token</code> endpoint with your username and password to retrieve and save a new authorization token.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span><span class="op">$</span><span class="fu">login</span><span class="op">(</span><span class="st">"myusername"</span>, <span class="st">"mypassword"</span><span class="op">)</span> <span class="co"># if successful, this saves an authorization token </span></span>
<span><span class="va">wheat</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"/germplasm"</span><span class="op">)</span> <span class="co"># this request will automatically have the authorization token added to it, you don't need to do anything differently</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-databases">Other Databases<a class="anchor" aria-label="anchor" href="#other-databases"></a>
</h3>
<p>If you’re connecting to a non-breedbase database that requires authorization, you will need to manually request an authorization token. Once you have it, you can use the <code>login(token = "myAuthToken")</code> function to save the token for future requests.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span><span class="op">$</span><span class="fu">login</span><span class="op">(</span>token <span class="op">=</span> <span class="st">"myAuthToken"</span><span class="op">)</span> <span class="co"># this will store your auth token as-is for future requests</span></span>
<span><span class="va">wheat</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"/germplasm"</span><span class="op">)</span> <span class="co"># this request will automatically have the authorization token added to it, you don't need to do anything differently</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="making-http-requests">Making HTTP Requests<a class="anchor" aria-label="anchor" href="#making-http-requests"></a>
</h2>
<p>Once you have a <code>BrAPIConnection</code> object, you can use it to make HTTP Requests to the BrAPI server. There is a separate helper function for each type of HTTP request.</p>
<ul>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-get">conn$get() function</a> - to make a GET request</li>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-post">conn$post() function</a> - make a POST request</li>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-put">conn$put() function</a> - make a PUT request</li>
</ul>
<div class="section level3">
<h3 id="request-parameters">Request Parameters<a class="anchor" aria-label="anchor" href="#request-parameters"></a>
</h3>
<p>Each of the request functions (<code>get</code>, <code>post</code>, <code>put</code>) can take the following parameters:</p>
<ul>
<li>
<code>call</code> - The BrAPI endpoint to make the request to</li>
<li>
<code>query</code> - (optional) A named list of query parameters</li>
<li>
<code>body</code> - (optional) A named list or vector of body parameters (this will be automatically converted to JSON)</li>
<li>
<code>page</code> - (optional) the index of the page of results to return (DEFAULT: 0)
<ul>
<li>When <code>page="all"</code>, all of the available pages will be fetched sequentially and the response properties of all of the individual pages along with the combined data from all of the pages will be returned</li>
</ul>
</li>
<li>
<code>pageSize</code> - (optional) the maximum size of the page of results to return (DEFAULT: 10)</li>
</ul>
</div>
<div class="section level3">
<h3 id="response-format">Response Format<a class="anchor" aria-label="anchor" href="#response-format"></a>
</h3>
<p>The return value for each of the request functions (<code>get</code>, <code>post</code>, <code>put</code>) will return a named list containing the properties of the Response.</p>
<p>For a singe-page request:</p>
<ul>
<li>
<code>response</code> - the <code>httr</code> response object</li>
<li>
<code>status</code> - the parsed HTTP status</li>
<li>
<code>content</code> - the full content of the body of the response</li>
<li>
<code>metadata</code> - the metadata object from the body of the reponse, if returned</li>
<li>
<code>data</code> - the data object from the body of the response, if returned</li>
</ul>
<p>For a multi-page request (when <code>page="all"</code>):</p>
<ul>
<li>
<code>response</code> - a list of the <code>httr</code> response object by page</li>
<li>
<code>status</code> - a list of the parsed HTTP status by page</li>
<li>
<code>content</code> - a list of the full content of the body of the response by page</li>
<li>
<code>metadata</code> - a list of the metadata object from the body of the response by page, if returned</li>
<li>
<code>data</code> - a list of the data object from the body of the response by page, if returned</li>
<li>
<code>combined_data</code> - a combined vector of the data from all of the pages, if returned</li>
</ul>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GET Request</span></span>
<span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/Wheat"</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"/studies"</span>, query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>programName<span class="op">=</span><span class="st">"Cornell University"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># POST Request</span></span>
<span><span class="va">sandbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBrAPIConnection.html">createBrAPIConnection</a></span><span class="op">(</span><span class="st">"wheat-sandbox.triticeaetoolbox.org"</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observationUnitDbId<span class="op">=</span><span class="st">"ou1"</span>, observationVariableDbId<span class="op">=</span><span class="st">"ov1"</span>, value<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observationUnitDbId<span class="op">=</span><span class="st">"ou2"</span>, observationVariableDbId<span class="op">=</span><span class="st">"ov1"</span>, value<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">sandbox</span><span class="op">$</span><span class="fu">post</span><span class="op">(</span><span class="st">"/token"</span>, query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>username<span class="op">=</span><span class="st">"testing"</span>, password<span class="op">=</span><span class="st">"testing123"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">sandbox</span><span class="op">$</span><span class="fu">post</span><span class="op">(</span><span class="st">"/observations"</span>, body<span class="op">=</span><span class="va">data</span>, token<span class="op">=</span><span class="va">resp</span><span class="op">$</span><span class="va">content</span><span class="op">$</span><span class="va">access_token</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PUT Request</span></span>
<span><span class="va">sandbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBrAPIConnection.html">createBrAPIConnection</a></span><span class="op">(</span><span class="st">"wheat-sandbox.triticeaetoolbox.org"</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observationDbId <span class="op">=</span> <span class="st">"ob1"</span>, observationUnitDbId<span class="op">=</span><span class="st">"ou1"</span>, observationVariableDbId<span class="op">=</span><span class="st">"ov1"</span>, value<span class="op">=</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observationDbId <span class="op">=</span> <span class="st">"ob2"</span>, observationUnitDbId<span class="op">=</span><span class="st">"ou2"</span>, observationVariableDbId<span class="op">=</span><span class="st">"ov1"</span>, value<span class="op">=</span><span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">sandbox</span><span class="op">$</span><span class="fu">post</span><span class="op">(</span><span class="st">"/token"</span>, query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>username<span class="op">=</span><span class="st">"testing"</span>, password<span class="op">=</span><span class="st">"testing123"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">sandbox</span><span class="op">$</span><span class="fu">put</span><span class="op">(</span><span class="st">"/observations"</span>, body<span class="op">=</span><span class="va">data</span>, token<span class="op">=</span><span class="va">resp</span><span class="op">$</span><span class="va">content</span><span class="op">$</span><span class="va">access_token</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="search-function">Search Function<a class="anchor" aria-label="anchor" href="#search-function"></a>
</h3>
<p>The <a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-search">conn$search() function</a> is a helper function that can be used to perform a BrAPI two-step search. This function will make the initial request to the <code>/search/{datatype}</code> endpoint. If that is successful, it will then automatically fetch all of the results from the <code>/search/{datatype}/{searchResultsDbId}</code> endpoint.</p>
<p>For example, to search for and retrieve all of the observations from a specific trial:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/Wheat"</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">search</span><span class="op">(</span><span class="st">"/observations"</span>, body <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>studyDbIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7459</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># results$combined_data will contain all of the search results</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="breedbase-functions">Breedbase Functions<a class="anchor" aria-label="anchor" href="#breedbase-functions"></a>
</h2>
<p>This package includes some breedbase-specific helper functions for performing some non-BrAPI compliant tasks that are available on breedbase. The <code>BrAPIConnection</code> object needs to have the <code>is_breedbase</code> argument set to <code>TRUE</code> in order for these functions to be enabled.</p>
<ul>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-wizard">conn$wizard() function</a> - filter data using the breedbase Search Wizard</li>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-vcf">conn$vcf() function</a> - download a breedbase-generated VCF file for a genotyping protocol, optionally filtered by accessions</li>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-vcf_archived">conn$vcf_archive() function</a> - download a static, archived VCF for an entire genotyping project</li>
<li>
<a href="https://triticeaetoolbox.github.io/BrAPI.R/reference/BrAPIConnection.html#method-BrAPIConnection-vcf_imputed">conn$vcf_imputed() function</a> - download a static VCF of imputed data for an imputed genotyping project (not all genotyping projects have been imputed)</li>
</ul>
<div class="section level3">
<h3 id="search-wizard-connwizarddata_type-filters-verbose">Search Wizard: <code>conn$wizard(data_type, filters, verbose)</code>
<a class="anchor" aria-label="anchor" href="#search-wizard-connwizarddata_type-filters-verbose"></a>
</h3>
<p>The breedbase Search Wizard is a great tool for quickly filtering and combining datasets in the database. You can use it to request data of a specific data type that matches specified filter criteria. The filter criteria can be specified by either the IDs or the names of the items. However, if you use names, the function will perform additional queries to lookup the IDs for the named items. If you already have the IDs, it is better to use those.</p>
<p>For example, you can use it to find the genotyping protocols that have data from a set of accessions that were observed in a set of field trials.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/WheatCAP"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find accessions that were observed in these two trials</span></span>
<span><span class="va">accessions</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">wizard</span><span class="op">(</span><span class="st">"accessions"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CornellMaster_2024_Helfer"</span>, <span class="st">"CornellMaster_2025_McGowan"</span><span class="op">)</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get genotyping protocols that have data for any of the trial's accessions</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">wizard</span><span class="op">(</span><span class="st">"genotyping_protocols"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>accessions <span class="op">=</span> <span class="va">accessions</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The Search Wizard response data will include the ids, names, and a map of names -&gt; ids for the matching data:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> geno<span class="sc">$</span>data<span class="sc">$</span>ids</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">265</span> <span class="dv">287</span> <span class="dv">130</span> <span class="dv">242</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="sc">&gt;</span> geno<span class="sc">$</span>data<span class="sc">$</span>names</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"GBS Cornell 2024"</span>  <span class="st">"GBS Cornell 2025"</span>  <span class="st">"GBS CornellMaster"</span>  <span class="st">"GBS MSU"</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="sc">&gt;</span> geno<span class="sc">$</span>data<span class="sc">$</span>map</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="sc">$</span><span class="st">`</span><span class="at">GBS Cornell 2024</span><span class="st">`</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">265</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="sc">$</span><span class="st">`</span><span class="at">GBS Cornell 2025</span><span class="st">`</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">287</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="sc">$</span><span class="st">`</span><span class="at">GBS CornellMaster</span><span class="st">`</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">130</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="sc">$</span><span class="st">`</span><span class="at">GBS MSU</span><span class="st">`</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">242</span></span></code></pre></div>
<p>The <code>filters</code> argument can contain up to 3 different filters. The name of the list item is one of the supported breedbase data types: accessions, organisms, breeding_programs, genotyping_protocols, genotyping_projects, locations, plants, plots, tissue_sample, seedlots, trait_components, traits, trials, trial_designs, trial_types, years</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find all trials from these two breeding programs from one year</span></span>
<span><span class="va">trials</span> <span class="op">&lt;-</span> <span class="va">wheat</span><span class="op">$</span><span class="fu">wizard</span><span class="op">(</span><span class="st">"trials"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>breeding_programs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">327</span>,<span class="fl">367</span><span class="op">)</span>, years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downloading-vcf-files-connvcfoutput-genotyping_protocol_id-accessions">Downloading VCF Files: <code>conn$vcf(output, genotyping_protocol_id, accessions)</code>
<a class="anchor" aria-label="anchor" href="#downloading-vcf-files-connvcfoutput-genotyping_protocol_id-accessions"></a>
</h3>
<p>If the BrAPI genotyping endpoints are too slow, you can try downloading VCF files of the genotyping data using the internal breedbase endpoints that are used to download genotyping data from the Search Wizard. To use the <code>conn$vcf()</code> function, you’ll need to provide the path to the output file where the VCF file will be saved on your computer, the database id of the genotyping protocol, and (optionally) a list of database ids of accessions to use as a filter on the genotype data.</p>
<p>To download an entire genotyping protocol:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/WheatCAP"</span><span class="op">)</span></span>
<span><span class="va">wheat</span><span class="op">$</span><span class="fu">vcf</span><span class="op">(</span><span class="st">"~/Desktop/my_data.vcf"</span>, genotyping_protocol_id <span class="op">=</span> <span class="fl">249</span><span class="op">)</span></span></code></pre></div>
<p>To download a subset of accessions from a genotyping protocol:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getBrAPIConnection.html">getBrAPIConnection</a></span><span class="op">(</span><span class="st">"T3/WheatCAP"</span><span class="op">)</span></span>
<span><span class="va">wheat</span><span class="op">$</span><span class="fu">vcf</span><span class="op">(</span><span class="st">"~/Desktop/my_data.vcf"</span>, genotyping_protocol_id <span class="op">=</span> <span class="fl">249</span>, accessions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">228677</span>, <span class="fl">1666408</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Depending on the size of the genotyping protocol (number of markers) and the number of accessions to download, <strong>this download function may still take a long time to download</strong>. If the function times out, you may want to try to download an archived VCF file of the data.</p>
</div>
<div class="section level3">
<h3 id="downloading-archived-vcf-files-connvcf_archivedoutput-genotyping_protocol_id-genotyping_project_id-file_name">Downloading Archived VCF Files: <code>conn$vcf_archived(output, genotyping_protocol_id, genotyping_project_id, file_name)</code>
<a class="anchor" aria-label="anchor" href="#downloading-archived-vcf-files-connvcf_archivedoutput-genotyping_protocol_id-genotyping_project_id-file_name"></a>
</h3>
<p>This function will allow you to download a static, archived VCF file for a specific genotyping project, when available. These files are the original VCF files that were used to upload the data to the database.</p>
<p>The archived files are saved at the project level. So, if you specify a protocol, you’ll get a list of all of the available files for each project in that protocol and you can select which one to download. If you’re performing analysis at the protocol level, you’ll need to manually merge the VCF files from each project in that protocol.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="sc">&gt;</span> wheat <span class="ot">&lt;-</span> <span class="fu">getBrAPIConnection</span>(<span class="st">"T3/Wheat"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="sc">&gt;</span> resp <span class="ot">&lt;-</span> wheat<span class="sc">$</span><span class="fu">vcf_archived</span>(<span class="st">"~/Desktop/my_data.vcf"</span>, <span class="at">genotyping_protocol_id=</span><span class="dv">297</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>Finding archived VCF files...</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  Genotyping Protocol<span class="sc">:</span> <span class="dv">297</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>Found <span class="dv">4</span> files...</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="sc">-</span><span class="ot">-&gt;</span> Select a file to download<span class="sc">:</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>[<span class="co">#] Project Name (Protocol Name) [File Name]</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="sc">--------------------------------------------</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>[<span class="dv">1</span>] Allegro V1 <span class="fu">tempate</span> (Allegro V1) [<span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">51</span><span class="sc">:</span><span class="dv">07</span>_fileuEjk]</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>[<span class="dv">2</span>] <span class="fu">KSU_2023_Allegro</span> (Allegro V1) [<span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">07</span><span class="sc">:</span><span class="dv">44</span>_fileFJaf]</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>[<span class="dv">3</span>] <span class="fu">KSU_2023_Allegro_AeTa</span> (Allegro V1) [<span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">28</span><span class="sc">:</span><span class="dv">16</span>_filee3Si]</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>[<span class="dv">4</span>] <span class="fu">UCD_2020_Allegro</span> (Allegro V1) [<span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">53</span><span class="sc">:</span><span class="dv">02</span>_filepq5P]</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="sc">-</span><span class="ot">-&gt;</span> Enter file number<span class="sc">:</span> <span class="dv">4</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>Response [GET] <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>wheatcap.triticeaetoolbox.org<span class="sc">/</span>ajax<span class="sc">/</span>genotyping_project<span class="sc">/</span>download_archived_vcf?genotyping_project_id<span class="ot">=</span><span class="dv">10371</span><span class="sc">&amp;</span>basename<span class="ot">=</span><span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">53</span><span class="sc">:</span><span class="dv">02</span>_filepq5P<span class="sc">&gt;</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  Success<span class="sc">:</span> (<span class="dv">200</span>) OK</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  Protocol<span class="sc">:</span> Allegro <span class="fu">V1</span> (<span class="dv">297</span>)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  Project<span class="sc">:</span> <span class="fu">UCD_2020_Allegro</span> (<span class="dv">10371</span>)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  File Name<span class="sc">:</span> <span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">53</span><span class="sc">:</span><span class="dv">02</span>_filepq5P</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  Output File<span class="sc">:</span> <span class="er">~/</span>Desktop<span class="sc">/</span>my_data.vcf</span></code></pre></div>
<p>If you know which file you want to download, you can add the archived file’s file name as the <code>file_name</code> argument to the <code>vcf_archived()</code> function. When there is only one matching file, that file will be automatically downloaded to the output file (you won’t be prompted to select a file).</p>
<p>If you want to get a table of available files before requesting a download, you can do so with the <code>vcf_archived_list()</code> function, which also takes a <code>genotyping_protocol_id</code> and/or <code>genotyping_project_id</code> as arguments. This will return a data frame with the protocol id and name, project id and name, and file name of the available archived files for your request. You can then use one of the returned file names as the <code>file_name</code> argument in the <code>vcf_archived()</code> download function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="sc">&gt;</span> files <span class="ot">&lt;-</span> wheat<span class="sc">$</span><span class="fu">vcf_archived_list</span>(<span class="at">genotyping_protocol_id=</span><span class="dv">297</span>, <span class="at">verbose=</span>T)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>Finding archived VCF files...</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  Genotyping Protocol<span class="sc">:</span> <span class="dv">297</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>Found <span class="dv">4</span> files...</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="sc">&gt;</span> files</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  protocol_id protocol_name project_id          project_name                    file_name</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">297</span>    Allegro V1      <span class="dv">13533</span>    Allegro V1 tempate <span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">51</span><span class="sc">:</span><span class="dv">07</span>_fileuEjk</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">297</span>    Allegro V1      <span class="dv">11359</span>      KSU_2023_Allegro <span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">07</span><span class="sc">:</span><span class="dv">44</span>_fileFJaf</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">297</span>    Allegro V1      <span class="dv">13534</span> KSU_2023_Allegro_AeTa <span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">28</span><span class="sc">:</span><span class="dv">16</span>_filee3Si</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="dv">2</span>         <span class="dv">297</span>    Allegro V1      <span class="dv">10371</span>      UCD_2020_Allegro <span class="dv">2025-09-03</span>_18<span class="sc">:</span><span class="dv">53</span><span class="sc">:</span><span class="dv">02</span>_filepq5P</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="sc">&gt;</span> resp <span class="ot">&lt;-</span> wheat<span class="sc">$</span><span class="fu">vcf_archived</span>(<span class="st">"~/Desktop/geno_data.vcf"</span>, <span class="at">genotyping_protocol_id=</span><span class="dv">297</span>, <span class="at">file_name=</span><span class="st">"2025-09-03_19:07:44_fileFJaf"</span>, <span class="at">verbose=</span>T)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>Finding archived VCF files...</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  Genotyping Protocol<span class="sc">:</span> <span class="dv">297</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>Found <span class="dv">4</span> files...</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>Response [GET] <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>wheatcap.triticeaetoolbox.org<span class="sc">/</span>ajax<span class="sc">/</span>genotyping_project<span class="sc">/</span>download_archived_vcf?genotyping_project_id<span class="ot">=</span><span class="dv">11359</span><span class="sc">&amp;</span>basename<span class="ot">=</span><span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">07</span><span class="sc">:</span><span class="dv">44</span>_fileFJaf<span class="sc">&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  Success<span class="sc">:</span> (<span class="dv">200</span>) OK</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  Protocol<span class="sc">:</span> Allegro <span class="fu">V1</span> (<span class="dv">297</span>)</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>  Project<span class="sc">:</span> <span class="fu">KSU_2023_Allegro</span> (<span class="dv">11359</span>)</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>  File Name<span class="sc">:</span> <span class="dv">2025-09-03</span>_19<span class="sc">:</span><span class="dv">07</span><span class="sc">:</span><span class="dv">44</span>_fileFJaf</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>  Output File<span class="sc">:</span> <span class="er">~/</span>Desktop<span class="sc">/</span>geno_data.vcf</span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing BrAPI</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Waring <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9971-9776" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Waring.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
